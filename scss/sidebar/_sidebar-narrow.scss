%sidebar-narrow {
  @include media-breakpoint-up($mobile-breakpoint) {
    z-index: $zindex-fixed + 1;
    flex: 0 0 $sidebar-narrow-width;
    padding-bottom: $sidebar-toggler-height;
    overflow: visible;

    &.sidebar-fixed {
      z-index: $zindex-fixed + 1;
      width: $sidebar-narrow-width;
    }

    .sidebar-brand-full {
      display: none;
    }

    .sidebar-brand-narrow {
      display: block;
    }

    .d-narrow-none,
    .nav-label,
    .nav-title,
    .nav-group-items,
    .nav-group.show .nav-group-items,
    .sidebar-footer,
    .sidebar-form,
    .sidebar-header {
      height: 0 !important; // stylelint-disable-line declaration-no-important
      padding: 0;
      margin: 0;
      visibility: hidden;
      opacity: 0;
    }

    .sidebar-toggler {
      position: fixed;
      bottom: 0;

      &::before {
        transform: rotate(-180deg);
      }
    }

    &.sidebar-right .sidebar-toggler::before {
      transform: rotate(0deg);
    }
  }
}

.sidebar-narrow {
  @extend %sidebar-narrow;
}

.sidebar-narrow-unfoldable {

  &:not(:hover) {
    @extend %sidebar-narrow;
  }

  &:hover {
    .sidebar-toggler {
      &::before {
        transform: rotate(-180deg);
      }
    }

    &.sidebar-right .sidebar-toggler::before {
      transform: rotate(0deg);
    }
  }
}

// Responsive behavior
// stylelint-disable selector-max-class
@each $breakpoint in map-keys($grid-breakpoints) {
  @include media-breakpoint-up($breakpoint) {
    $infix: breakpoint-infix($breakpoint, $grid-breakpoints);
    .sidebar.sidebar#{$infix}-show,
    .sidebar.sidebar-show {
      &:not(.sidebar-right){
        margin-left: 0;
        @include media-breakpoint-up($mobile-breakpoint) {
          &.sidebar-fixed {
            &.sidebar-narrow,
            &.sidebar-narrow-unfoldable {
              ~ [data-coreui-reliant="sidebar"] {
                margin-left: $sidebar-narrow-width;
              }
            }
          }
        }
      }
      &.sidebar-right {
        margin-right: 0;
        @include media-breakpoint-up($mobile-breakpoint) {
          &.sidebar-fixed {
            &.sidebar-narrow,
            &.sidebar-narrow-unfoldable {
              ~ [data-coreui-reliant="sidebar"] {
                margin-right: $sidebar-narrow-width;
              }
            }
          }
        }
      }
    }
  }
}
